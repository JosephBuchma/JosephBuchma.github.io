<!DOCTYPE html>
<html>
<head>

  <meta charset="UTF-8">
  <title>Keep calm in Go - panic, defer and recover</title>
  <meta name="viewport" content="width=device-width">

  <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href='https://fonts.googleapis.com/css?family=Roboto+Condensed:300' rel='stylesheet' type='text/css'>
  <link href="/assets/css/style.css" rel="stylesheet" />
  <link href="/assets/css/colors-light.css" rel="stylesheet" />

</head>

<body>



  <header id="header">
    <h1><a href="/"> Joseph Buchma</a></h1>
    <p>Dev blog</p>
  </header>



  <div id="page">



    <div id="sidebar">
      <nav>
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/archives">Archive</a></li>
          <li><a href="/about">About</a></li>
          <li><a href="/feed.xml">RSS Feed</a></li>
        </ul>
      </nav>
    </div>



    <div id="content">
      <article class="post">

	
		<h1><a href="/2015/11/30/go-panic-defer-recover/">Keep calm in Go - panic, defer and recover</a></h1>
	
  
  <ul class="tags">
    
      <li>
        <a href="/tag/golang">golang</a>
      </li>
    
    </ul>
  

	<div class="post-content"><p>Normally you work with “exceptions” in golang by simply returning <code>error</code> from function
and then checking it in <code>if</code> statement when calling it. But sometimes
traditional <em>“try … catch … finally”</em> may be more convenient. It can be
achieved using golang’s <code>panic</code>, <code>defer</code> and <code>recover</code>.</p>

<p>Here is example of <code>try ... catch ... finally</code> in Go:</p>

<div class="highlight"><pre><code class="language-go" data-lang="go"><span class="kn">import</span> <span class="s">&quot;fmt&quot;</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">(){</span>
  <span class="c1">// finally</span>
  <span class="k">defer</span> <span class="kd">func</span><span class="p">(){</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;FINALIZATION&quot;</span><span class="p">)</span>
  <span class="p">}()</span>

  <span class="c1">// catch</span>
  <span class="k">defer</span> <span class="kd">func</span><span class="p">(){</span>
    <span class="k">if</span> <span class="nx">exception</span> <span class="o">:=</span> <span class="nb">recover</span><span class="p">();</span> <span class="nx">exception</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
      <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;`Exception` catched: %v\n&quot;</span><span class="p">,</span> <span class="nx">exception</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}()</span>

  <span class="c1">// try</span>
  <span class="nx">x</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">x</span><span class="p">[</span><span class="mi">35</span><span class="p">])</span> <span class="c1">// this line will panic (e.g. throw exception):</span>
                     <span class="c1">// &quot;index out of range&quot;</span>
<span class="p">}</span></code></pre></div>

<p>You can panic with your custom exceptions of any type. Then you just check type
of recovered panic using typeswitch or reflect package…</p>

<p>As proof of concept (and for fun) I created <a href="https://github.com/JosephBuchma/calmly">Calmly
package</a></p>
</div>

	<p class="meta">Posted on <span class="postdate">Nov 30, 2015</span></p>

</article>
    </div>


    <div id="tagcloud">
      <h2>Tags cloud</h2>
      <ul class="tags list">
          
            <li>
            <a href="/tag/vim">vim</a>
            </li>
          
            <li>
            <a href="/tag/tmux">tmux</a>
            </li>
          
            <li>
            <a href="/tag/editors">editors</a>
            </li>
          
            <li>
            <a href="/tag/devtools">devtools</a>
            </li>
          
            <li>
            <a href="/tag/shell">shell</a>
            </li>
          
            <li>
            <a href="/tag/zsh">zsh</a>
            </li>
          
            <li>
            <a href="/tag/bash">bash</a>
            </li>
          
            <li>
            <a href="/tag/workflow">workflow</a>
            </li>
          
            <li>
            <a href="/tag/rspec">rspec</a>
            </li>
          
            <li>
            <a href="/tag/xvfb">xvfb</a>
            </li>
          
            <li>
            <a href="/tag/golang">golang</a>
            </li>
          
            <li>
            <a href="/tag/jekyll">jekyll</a>
            </li>
          
            <li>
            <a href="/tag/github">github</a>
            </li>
          
            <li>
            <a href="/tag/githubpages">githubpages</a>
            </li>
          
            <li>
            <a href="/tag/testing">testing</a>
            </li>
          
      </ul>
    </div>


  </div>



  <footer id="footer">
    <p class="copyright">Copyright &copy; 2015 Joseph Buchma. Powered by <a href="http://jekyllrb.com">Jekyll</a>, based on theme by <a href="http://www.webmaster-source.com">Matt Harzewski</a></p>
  </footer>



  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
  <script src="/assets/js/jquery.mobilemenu.min.js"></script>

  <script>
    $(document).ready(function(){
      $('#sidebar nav ul').mobileMenu({'topOptionText': 'Menu', 'prependTo': '#sidebar nav'});
    });
  </script>



</body>
</html>